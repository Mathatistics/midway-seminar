---
title: "PhD Midway Seminar"
author: "Raju Rimal"
date: "`r format(Sys.Date(), '%d %B, %Y')`"
output:
  revealjs::revealjs_presentation:
    background_transition: fade
    center: no
    css: css/custom.css
    highlight: tango
    reveal_options:
      pdfMaxPagesPerSlide: 1
      previewLinks: yes
    reveal_plugins:
    - notes
    - zoom
    - chalkboard
    self_contained: no
    theme: night
  ioslides_presentation:
    highlight: tango
    logo: images/LogoNMBUsquare.png
    smaller: yes
    widescreen: yes
  beamer_presentation:
    citation_package: natbib
    colortheme: seahorse
    fonttheme: serif
    highlight: tango
    includes:
      in_header: header.tex
    keep_tex: yes
    slide_level: 2
    theme: Madrid
institute: |
  | **Supervisors**
  | Solve Sæbø, Tryge Almøy
csl: apa.csl
subtitle: <small>Simulation Tool and its application</small>
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
ifnot.beamer <- knitr::opts_knit$get("rmarkdown.pandoc.to") != "beamer"
```

```{r}
library(data.table)
library(ggplot2)
library(simrel)
```


Introduction {data-background=#fff .header-slide}
=============================================================================

## My PhD Plan {data-background=#e2e2e2 .header-slide}

<div id = "left" class = "fragment">
```{r eval = ifnot.beamer}
knitr::include_graphics("images/phd-plan.svg")
```
</div>
<br>
<div id = "right">
> - Make <span class="fragment highlight-blue">Simulation Tools</span> for multi-response linear model data
> - Using the tool, compare various <span class="fragment highlight-bold">estimation techniques</span> and <span class="fragment highlight-bold">understand</span> them
> - <span class="fragment highlight-bold">Extend</span> the simulation tool incorporating model with <span class="fragment highlight-bold">background information</span>
> - Apply this extended tool to <span class="fragment highlight-blue">test multi-matrix extension of PLS</span> models such as LPLS and UPLS
</div>

## What I learn {data-background=#e2e2e2 .header-slide}
> - Advanced Multivariate Model and technique to analyze it
> - Programming concept for developing statistical packages and applications for various statistical methods
> - Extending and improving existing methods in statistics
> - And, Obviously, to properly document what I have done

## Today's Special {data-background=#e2e2e2 .header-slide}

<div class="fragment">Today I will talk about:</div><br/>

> - Simulation tool (<span class="fragment highlight-blue">`simulatr`</span>) we are building
> - A <span class="fragment highlight-blue">comparative study</span> of various estimation techniques by simulating linear model data using `simulatr`

`simrel-m`: A versatile tool for simulating multi-response linear model data {data-background=#fff .header-slide}
=============================================================================

## Overview {data-background=#e2e2e2 .header-slide}
> - An extension of `simrel` [@saebo2015simrel] r-package
> - Uses the idea of reduction of random regression model by separating latent space of $\mathbf{X}$ into subspaces that is relevant and irrelevant for predicting each response
> - The underlying concept is based on reparameterizing the population model, 
$$
\mathbf{Y} = \boldsymbol{\mu}_{Y} + \mathbf{B}^t\left(\mathbf{X} - \boldsymbol{\mu}_X\right) + \boldsymbol{\epsilon}
$$
where, $\boldsymbol{\epsilon} \sim N(0, \boldsymbol{\Sigma}_{Y|X})$


## Underlying procedure {data-background=#e2e2e2 .header-slide}

<div id = "left" class = "fragment">

```{r, eval = ifnot.beamer}
knitr::include_graphics("images/simrel-broad-flowchart.svg")
```

</div>

<div id = "right">

> - Collect population input parameter from users such as: number of variables, coefficient of determination and the position of relevant components
> - Make a covariance matrix satisfying input parameters
> - Rotate the covariance matrix orthogonally
> - Sample calibration and validation sets

</div>

A comparative study of different estimation methods using simulated data {data-background=#fff .header-slide}
=============================================================================

## Overview {data-background=#e2e2e2 .header-slide}

##### Four estimtion methods were considered {.fragment}

<br/>
<div class = "fragment">

<div id = "left">

#### Ordinary Least Squares {.fragment .highlight-current-mediumgreen}
- Although unbiased, suffer highly from multicollinearity
- Widely used and can be used as reference for comparison


#### Envelope {.fragment .highlight-current-blue}
- Based on Maximum Likelihood but works better than OLS in $p$ approaches $n$
- Our analysis is based on envelope of predictor or `xenvelope`

</div>

<div id = "right">

#### Partial Least Squares {.fragment .highlight-current-purple} 
- Well established and widely used method
- Based on Latent Structure and free of multicollinearity problem


#### Bayes PLS {.fragment .highlight-current-red}
- Bayesian Estimation of regression coefficient
- Promising performance was shown in previous studies [@helland2012near]

</div>
</div>

## Simulation Design {data-background=#e2e2e2 .header-slide}
From the possible combination of following parameter combination, *32* calibration sets were simulated with *5* replication of each.

> - **Number of sample observations**: _50_
> - **Number of predictor variables**: _15_ and _40_
> - **Coefficient of determination**: _0.5_ and _0.9_
> - **Decaying factor of eigenvalues of predictor variables**: _0.5_ and _0.9_
> - **Position of relevant components**: _1_ and _2_; _1_ and _3_; _2_ and _3_; _1_, _2_ and _3_

## A Systematic Comparison {data-background=#e2e2e2 .header-slide}
<div class="fragment">

```{r, out.width="60%"}
knitr::include_graphics("images/effect-plot.png")
```
</div>

<div class = "fragment">
<div id = "left">
- Bayes PLS has out-performed others methods in all kinds of data
- Envelope has performed better than OLS in all situations and PLS in some situations
</div>
<div id = "right">
- OLS prediction is very poor in noisy data with many predictor variables
- Position of relvant component and the decaying factor of eigenvalue has less impact on prediction in all the models
</div>
</div>

## A Systematic Comparison {data-background=#e2e2e2 .header-slide data-transition="none"}

<div class="fragment">

```{r, out.width="60%"}
knitr::include_graphics("images/prediction-error-selected.png")
```

</div>

<div class = "fragment">
<div id = "left">
- Bayes PLS has approached to its minimum error with very few component and remained low for additional component
- PLS has moderate performance but better than envelope in many situations.
</div>
<div id = "right">
- OLS prediction is poor especially with large number of predictor
- Envelope method captured its minimum error and the error increased with additional components
</div>
</div>


Demonstration {data-background=#fff .header-slide .center}
=============================================================================

## { data-background-image='images/simulatr-screenshot.png' data-background-color=#e2e2e2 .header-slide}
<h1><a href = "https://therimalaya.shinyapps.io/simulatr/" class = "big-text">
`simulatr` APPLICATION
</a></h1>

# {data-background-image='images/ThankYou.jpg' data-background-size='90% 90%' data-background-color=#fff}

# References
## References {data-background=#e2e2e2 .header-slide}
